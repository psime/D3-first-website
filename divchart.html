<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>My first D3 Website</title>
  <p></p>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <div id="chart"></div>
  <h1 id="holder" style="text-align: center; width: 850px;">Countries by population</h1>
  <br>
  <script>

    const data = [
      {
        country: "Germany",
        population: 84,
        growth: "Grew from 81M to 84M (2014-2024), driven almost entirely by immigration. Without migrants, population would be shrinking due to more deaths than births each year."
      },
      {
        country: "UK",
        population: 68,
        growth: "Grew from 64M to 68M (2014-2024). Net migration hit record highs post-Brexit. Birth rate has fallen to its lowest level since records began."
      },
      {
        country: "France",
        population: 68,
        growth: "Grew modestly from 66M to 68M (2014-2024). Has one of Europe's highest birth rates but it has been declining. Migration now the main growth driver."
      },
      {
        country: "Italy",
        population: 59,
        growth: "Actually shrinking â€” peaked at 60.3M in 2014 and has fallen to 59M by 2024. One of Europe's lowest birth rates (6.7 births per 1000 people) and an ageing population."
      },
      { country: "Spain", population: 47, growth: "some info" },
      { country: "Poland", population: 38, growth: "some info" },
      { country: "Romania", population: 19, growth: "some info" },
      { country: "Netherlands", population: 17, growth: "some info" },
      { country: "Belgium", population: 11, growth: "some info" },
      { country: "Greece", population: 10, growth: "some info" }
    ];


    let gr = 50;
    //     alert(gr);
    // alert(gr);
    // let gr = document.getElementById("user_input").text;

    for (let i = 0; i < data.length; i++) {
      const mydiv = document.createElement("p");
      console.log(mydiv);
      document.body.appendChild(mydiv);
    }
    // Filter large countries, then extract names
    const largeCountryNames = data.filter((d) => {
      return d.population > 30;
    });
    // .map((d) => {
    //   return d.country + " - " + d.population + "M";
    // });

    console.log(largeCountryNames);

    const extrabig = largeCountryNames
      .filter((d) => d.population > 50)
      .sort((a, b) => b.population - a.population)


    // 1. Filter the data (e.g., population over 50)
    const filtered = extrabig

    const tooltip = document.createElement("div");
    tooltip.style.position = "fixed";
    tooltip.style.backgroundColor = "rgba(185, 135, 135, 1.45)";
    tooltip.style.color = "#333";
    tooltip.style.textAlign = "functional";
    tooltip.style.padding = "14px";
    tooltip.style.borderRadius = "8px";
    tooltip.style.border = "1px solid #333";
    tooltip.style.fontSize = "16px";  // was 14px
    tooltip.style.fontWeight = "650";
    tooltip.style.pointerEvents = "none";
    tooltip.style.display = "none";
    tooltip.style.maxWidth = "275px";
    tooltip.style.zIndex = "9999";
    tooltip.style.boxShadow = "0 2px 6px rgba(0,0,0,0.5)";
    document.body.appendChild(tooltip);

    // let extrabig.country.sort(function(a, b){return b-a});
    // 2. Loop through the filtered results
    filtered.forEach((item) => {
      // Create the "Wrapper" Div
      const containerDiv = document.createElement("div");

      // --- DYNAMIC MARGIN ---
      // We use the population value and multiply it to make the visual difference obvious
      // Adjust the multiplier (e.g., * 2 or * 5) to see how it affects the "push"

      // --- DYNAMIC COLORS ---
      // You can use the population to change the brightness or color!
      // Example: Higher population = Darker grey
      const r = 255 - (item.population / 10) * 8;
      const g = 255 - (item.population / 10) * 18;
      const gr = 255 - (item.population / 10) * 25;
      let margreduce = (125 - item.population) * 3.5 + "px";
      // console.log(margreduce);

      containerDiv.style.margin = "15px";
      containerDiv.style.marginLeft = "80px";
      containerDiv.style.marginRight = margreduce;
      containerDiv.style.padding = "5px";
      containerDiv.style.paddingLeft = "20px";
      // containerDiv.style.backgroundColor = "#f0f0f0";
      //    containerDiv.style.backgroundColor = `rgb(${r}, ${g}, ${gr})`;
      containerDiv.style.border = "3px solid #000";
      // containerDiv.addEventListener("mouseover", () => {
      //   containerDiv.style.backgroundColor = `rgb(${r - 50}, ${g - 50}, ${gr - 50})`;
      // });
      // containerDiv.addEventListener("mouseout", () => {
      //   containerDiv.style.backgroundColor = `rgb(${r}, ${g}, ${gr})`;
      // });

      // Add transition for smooth movement
      containerDiv.style.transition = "transform 1.2s ease, background-color 0.8s ease";
      containerDiv.style.backgroundColor = `rgb(${r}, ${g}, ${gr})`;

      containerDiv.addEventListener("mouseover", () => {
        containerDiv.style.fontWeight = 800;
        containerDiv.style.backgroundColor = `rgb(${r - 70}, ${g - 70}, ${gr - 70})`;
        containerDiv.style.color = `rgb(${r + 500}, ${g + 500}, ${gr + 500})`;
        containerDiv.style.transform = "translateX(70px)";
      });
      containerDiv.addEventListener("click", (e) => {
        tooltip.textContent = item.growth;
        tooltip.style.display = "block";
        tooltip.style.left = e.clientX + 10 + "px";
        tooltip.style.top = e.clientY - 30 + "px";
      });

      containerDiv.addEventListener("mouseout", () => {
        containerDiv.style.backgroundColor = `rgb(${r}, ${g}, ${gr})`;
        containerDiv.style.transform = "translateX(0)";
        containerDiv.style.fontWeight = 'normal';
        tooltip.style.display = "none";  // hide tooltip when mouse leaves bar
      });
      // Create the Paragraph (keeping it separate for just the name)
      const myPara = document.createElement("p");
      myPara.textContent = item.country + " - " + item.population + "M";

      // NESTING
      containerDiv.appendChild(myPara);

      // ATTACHING
      document.body.appendChild(containerDiv);
    });
    // const extrabig = largeCountryNames
    //   .filter((d) => {
    //     return d.population > 70;
    //   })
    //   .map((d) => {
    //     return d.country;
    //   });
    // console.log(extrabig);
    // let myvar = document.getelementbyid("holder").text;
    console.log(extrabig);
  </script>
</body>

</html>